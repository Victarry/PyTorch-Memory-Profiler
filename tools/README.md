# PyTorch Memory Profiler Tools

This directory contains visualization tools for the PyTorch Memory Profiler.

## Setup with uv

This directory is configured to use [uv](https://github.com/astral-sh/uv) for fast Python package management.

### Installation

1. Install uv if you haven't already:
   ```bash
   curl -LsSf https://astral.sh/uv/install.sh | sh
   ```

2. Navigate to the tools directory:
   ```bash
   cd memory_profiler/tools
   ```

3. Install dependencies:
   ```bash
   uv sync
   ```

4. Install development dependencies (optional):
   ```bash
   uv sync --dev
   ```

### Running the Visualizer

You can run the memory visualizer in several ways:

#### Using uv run
```bash
# Run with a specific memory snapshot file
uv run streamlit run visualizer.py -- --file /path/to/snapshot.json

# Run without a file (will show file uploader)
uv run streamlit run visualizer.py
```

#### Using the installed script (after uv sync)
```bash
# Activate the virtual environment
source .venv/bin/activate

# Run streamlit directly
streamlit run visualizer.py -- --file /path/to/snapshot.json
```

### Development

#### Code Formatting
```bash
uv run black visualizer.py
```

#### Type Checking
```bash
uv run mypy visualizer.py
```

#### Linting
```bash
uv run flake8 visualizer.py
```

#### Running Tests
```bash
uv run pytest
```

## Features

The visualizer provides several views of memory usage:

1. **Phases**: Memory usage breakdown by execution phase
2. **Module Tree**: Hierarchical view of memory usage by PyTorch modules
3. **Stack Trace Groups**: Tensors grouped by their creation stack traces
4. **Tensor Details**: Detailed information about individual tensors

## Usage

The visualizer accepts memory snapshot JSON files generated by the PyTorch Memory Profiler. You can either:

1. Pass a file via command line: `--file snapshot.json`
2. Upload a file through the web interface
3. Use the file uploader in the Streamlit app

The tool will automatically detect multiple devices and allow you to select which device's memory usage to visualize. 